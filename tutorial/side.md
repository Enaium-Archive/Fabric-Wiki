## side
Minecraft使用[客户端 - 服务器模型](https://en.wikipedia.org/wiki/Client%E2%80%93server_model)，即用户安装游戏客户端并连接到服务器以玩游戏。Fabric允许mods以Minecraft客户端或Minecraft服务器为目标，但同时也是两者。

在过去，曾经有一个简单的划分到客户端和服务器，但随着单人游戏模式切换到内部专用服务器，这个简单的模型不再适合。因此，在Minecraft中区分客户端和服务器时，我们有两个维度。这些是物理和逻辑方面。

对于这两种类型的方，都有“客户”和“服务器”。但是，逻辑客户端不等同于物理客户端，逻辑服务器也不等同于物理服务器。逻辑客户端由物理客户端托管，逻辑服务器由物理服务器或物理客户端托管。

逻辑方面是Minecraft两个发行版架构的核心。因此，理解逻辑方面对于Fabric的任何mod开发都至关重要。

## 物理方面

物理方面或环境指的是Minecraft游戏的两个发行版（jar），客户端（vanilla发射器启动的内容）和服务器（可在[https://minecraft.net](https://minecraft.net/)上免费下载）。物理方面指的是当前环境中可用的代码。

客户端和服务器环境是同一程序的缩小分布，仅包含代码的必需部分。

在Fabric中，您经常可以看到注释
``` key
@Environment(EnvType.CLIENT)
```
这表明某些代码仅存在于一个环境中; 在这个例子中，客户端。

在Fabric fabric.mod.json和mixin配置中，客户端/服务器引用环境。

每个物理侧都有其入口点使用的类和带入口点的数据生成器类
``` key
net.minecraft.data.Main
```

## 逻辑方面
逻辑方面是关于实际的游戏逻辑。逻辑客户端进行渲染，将玩家输入发送到服务器，处理资源包并部分模拟游戏世界。服务器处理核心游戏逻辑，数据包并维护游戏世界的真实状态。

客户端维护服务器世界的部分副本，其中包含以下对象的副本：
``` key
net.minecraft.world.World 
net.minecraft.entity.Entity 
net.minecraft.block.entity.BlockEntity
```
这些复制对象允许客户端和服务器执行一些常见的游戏逻辑。客户端可以与这些对象进行交互，而服务器负责使它们保持同步。通常，要区分逻辑客户端上的对象与逻辑服务器上的对象，请访问对象的世界并检查其“isClient”字段。这可用于在服务器上执行权威操作（如生成实体）以及模拟客户端上的操作。该技术对于避免两个逻辑侧之间的不同步是必要的。
## 详细了解各方面
通过了解哪些方面以及如何在它们之间进行辨识，我们现在可以通过详细的外观来了解每一方。

### 物理客户端
物理客户端是vanilla发射器下载的Minecraft jar。它包含逻辑客户端和逻辑服务器（集成服务器）。它的切入点是
``` key
net.minecraft.client.main.Main。
```

由于物理客户端可以在单独的逻辑服务器中加载多个不同的世界，但一次只能加载一个。

与物理服务器（专用服务器）的逻辑服务器相比，物理客户端（集成服务器）的逻辑服务器可以由物理客户端上的逻辑客户端控制（例如，F3 + T重新加载数据包并关闭客户端）也关闭了集成服务器）。它还可以将捆绑在一个世界中的资源包加载到物理客户端上的逻辑客户端。

所有逻辑客户端内容都是物理客户端独有的。因此，您会在渲染，声音和其他逻辑客户端代码上看到许多环境注释。

一些mod专门针对物理客户端，例如，Liteloader，Optifine和Minecraft PvP客户端（Badlion，Hyperium）。

## 物理服务器
物理服务器是java专用服务器。与物理客户端相比，它只有一个逻辑服务器（专用服务器）。它的入口点是`net.minecraft.server.MinecraftServer`，物理服务器在运行时只能有一个世界。如果服务器应切换到另一个世界，则需要重新启动服务器。

其逻辑服务器与物理客户端略有不同，因为物理服务器运行时只存在一个逻辑服务器实例。此外，物理服务器的逻辑服务器可以通过Rcon远程控制，有一个名为server.properties的配置文件，并且可以发送服务器资源包。

尽管存在这些差异，但大多数mod都适用于物理客户端和物理服务器的逻辑服务器，只要它们不引用逻辑客户端内容即可。

然而，它的单一世界和资源包发送的功能使得vanilla mod（数据包和资源包组合）安装比在客户端上更容易，因为vanilla物理客户端在自动连接到服务器时设置。

有些mod专门针对物理服务器。例如，Bukkit及其衍生产品（Spigot，Paper，Cauldron，Xxx-Bukkit混合型）总是在物理服务器上运行。

## 逻辑客户端
逻辑客户端是播放器的接口。渲染（LWJGL），资源包，播放器输入处理和声音发生在逻辑客户端上。它不存在于物理服务器上。

## 逻辑服务器
逻辑服务器是执行大多数游戏逻辑的地方。数据包，世界更新，阻止实体和实体滴答，暴民AI，游戏/世界保存和世界生成，发生在逻辑服务器上。

物理客户端上的逻辑服务器称为“集成服务器”，而物理服务器上的逻辑服务器称为“专用服务器”（也是物理服务器本身的名称）。

逻辑服务器在其自己的主线程中运行，甚至在物理服务器上运行，并且具有一些工作线程。逻辑服务器的生命周期取决于它所托管的物理方面。在物理服务器上，只要进程正在运行，就会存在逻辑服务器。在物理客户端上，可以创建多个逻辑服务器，但一次只能存在一个逻辑服务器。当玩家加载本地保存时创建新的逻辑服务器，当玩家关闭本地保存时关闭。

大多数通用mod都以逻辑服务器为目标，因此它们可以在单人游戏和多玩家场景中工作。

## 通讯
通过交换数据包在逻辑客户端和服务器之间交换数据的唯一正确方法。数据包（如[https://wiki.vg](https://wiki.vg/)中所述）在逻辑客户端和逻辑服务器之间发送，而不是物理端。Mod可以添加数据包以在两个逻辑端之间传输自定义信息。数据包在内存中交换为连接到其自己的集成服务器的逻辑客户端，否则通过网络协议进行交换。

逻辑客户端将C2S（客户端到服务器）数据包发送到逻辑服务器。逻辑服务器向逻辑客户端发送S2C（服务器到客户端）数据包。数据包通过网络线程中的写入方法发送，并通过调用网络线程中的读取方法来接收。

有关如何处理网络的更多详细信息，请参阅[此文章](https://fabricmc.net/wiki/tutorial:networking)。

## 关于逻辑服务器的常见误解
大多数情况下，专门针对物理服务器的mod也可以在物理客户端内部的逻辑服务器上运行。

但是，物理服务器的modder通常具有不适用于集成服务器的假设，包括但不限于：

*一次游戏运行中只存在一个逻辑服务器实例
*世界和实体应始终计算游戏逻辑（即，世界对象的isClient字段始终为false）
*存在远程控制，资源包发送和Favicon
需要更正这些假设以生成在逻辑服务器上运行的mod。
## 结论
物理和逻辑方面的可能组合：
||逻辑客户端|逻辑服务器|
|----|----|----|
|物理客户端|单人总是存在|在本地保存时存在; 每场比赛的新实例
|物理服务器|不存在|单人总是存在